<head>
  <title>Admin Dashboard | Network Status</title>
  <link rel="stylesheet" href="../../css/dashboard.css" />
  <link rel="stylesheet" href="./index.css" />
  <script src="peerStatus.js" async></script>
</head>
<body>
  <div id="header">
    <img id="logo" src="../../asset/images/grey_logo.svg" width="50px" />
    <p id="headerText">Network</p>
    <button class="btn logout">
      <a style="text-decoration: none;color: inherit;" href="/api/auth/logout"
        >Log out</a
      >
    </button>
  </div>
  <div id="midContainer">
    <div id="sidebar">
      <a style="text-decoration: none;color: inherit" href="/dashboard/network">
        <div class="sidebarContent highlightSelected">
          <img src="../../asset/images/network.png" width="30px"/>
          <p>Network</p>
        </div>
      </a>
      <a style="text-decoration: none;color: inherit" href="/dashboard/database">
        <div class="sidebarContent">
          <img src="../../asset/images/database.svg" width="30px"/>
          <p>Database</p>
        </div>
      </a>
    </div class="sidebarContent">

    <!------------------------------------------------------------------------------------------------------------------------------>
    <div id="contentContainer" class="contents">
      <section class="sectionContainer">
          <div class="headerButtContainer">
              <strong class="sectionHeader">Channel Information</strong>
              <div class="channelbtn">
                <button type="button" class="positiveButton">
                  <img src="../../asset/images/add.svg" width="20px" />
                  <a href="./new.html">Add New</a>
                </button>
                <button type="button" class="positiveButton">
                  <img src="../../asset/images/add.svg" width="20px" />
                  <a href="./resgister.html">Register client</a>
                </button>
              </div>
          </div>
          <table class="table">
              <thead>
                  <tr>
                      <th>Organizations</th>
                      <th>Server</th>
                      <th>CA Server</th>
                      <th>Database Server</th>
                  </tr>
              </thead>
              <tbody class="tableContent" id="peerTable"></tbody>
          </table>
      </section>
      
      <section class="sectionContainer">
          <div class="headerButtContainer">
              <strong class="sectionHeader">Organizations Proposasl</strong>
          </div>
          <table class="table">
              <thead>
                  <tr>
                      <th>ID</th>
                      <th>Name</th>
                      <th>Admin</th>
                  </tr>
              </thead>

              <tbody class="tableContent" id="OrgStatus">
                  <tr>
                      <td>1</td>
                      <td>Company 1</td>
                      <td>admin1</td>
                      <td><button type="button" class="negativeButton">Kick</button></td>
                      <td><button type="button" class="utilButton">More details</button></td>
                  </tr>
                  
                  <tr>
                      <td>2</td>
                      <td>Company 2</td>
                      <td>admin2</td>
                      <td><button type="button" class="negativeButton">Kick</button></td>
                      <td><button type="button" class="utilButton">More details</button></td>
                  </tr>
              </tbody>
          </table>
      </section>
      <!------------------------------------------------------------------------------------------------------------------------------>
      
    </div>
  </div>
  <script>
    fetch("http://localhost:8080/api/auth/").then(res => {
      if(res.status != 200) {
        window.location.href = "http://localhost:8080/login.html";
      }
    })

    // init part
    fetch("http://localhost:8080/api/channel/getChannelInfo").then(res => res.json())
    .then(data => {
      // let table = document.getElementById("peerTable")
      document.getElementById("headerText").innerHTML = data.channelName
      for (node in data) {
        if(node == "channelName") continue
        let dataHTML = `
          <tr>
            <td>${node}</td>
            <td>${data[node].node}</td>
            <td>${data[node].caNode}</td>
            <td>${data[node].dbNode}</td>
            <td><button type="button" class="utilButton">Remove</button></td>
          </tr>
        `
      document.getElementById("peerTable").insertAdjacentHTML('beforeend', dataHTML)
      }
    }) 
  </script>
</body>
